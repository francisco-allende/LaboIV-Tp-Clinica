import{a as ct,b as st,c as dt}from"./chunk-IHR6FYAD.js";import{a as $,b as W,c as G,d as U}from"./chunk-STOCAUF7.js";import{k as v,l as j,m as at,n as A,o as B,p as L,q as N,r as F,s as w}from"./chunk-6XXJ4WYK.js";import{a as I,d as P,g as V,q as z,r as O}from"./chunk-FSE6CKWK.js";import{a as rt}from"./chunk-XBK3HTM3.js";import{a as lt}from"./chunk-ZUA55XGQ.js";import{a as it,b as nt}from"./chunk-BBSLOO33.js";import{a as et,b as ot}from"./chunk-LOM3YR3D.js";import"./chunk-F2BWO3NQ.js";import{a as tt}from"./chunk-OSX6DZ4Y.js";import{P as Z}from"./chunk-QWFAWHVU.js";import"./chunk-WXI33M2S.js";import"./chunk-K3IIDNEN.js";import{Cb as m,Db as s,Mb as c,Nb as T,Qb as E,Rb as k,Sb as D,Ub as C,Wa as d,Xa as u,g as b,kb as S,la as _,mb as X,nc as R,qb as M,rb as J,sb as Q,tb as Y,ua as f,ub as r,va as g,vb as l,wb as H,zb as x}from"./chunk-4VRYZ7GX.js";var _t=(()=>{let n=class n{constructor(e){this.dialogRef=e,this.rechazoReason=""}onConfirm(){this.rechazoReason!=""&&this.dialogRef.close(this.rechazoReason)}onCancel(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v))},n.\u0275cmp=_({type:n,selectors:[["app-rechazar-turno-dialog"]],standalone:!0,features:[C],decls:10,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],["appearance","fill",1,"w-100"],["matInput","","placeholder","Motivo del rechazo","rows","5",3,"ngModelChange","ngModel"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Rechazar Turno"),l(),r(2,"div",1)(3,"mat-form-field",2)(4,"textarea",3),D("ngModelChange",function(h){return k(o.rechazoReason,h)||(o.rechazoReason=h),h}),l()()(),r(5,"div",4)(6,"button",5),m("click",function(){return o.onCancel()}),c(7,"Cancelar"),l(),r(8,"button",5),m("click",function(){return o.onConfirm()}),c(9,"Confirmar"),l()()),t&2&&(d(4),E("ngModel",o.rechazoReason))},dependencies:[N,A,L,B,U,G,$,W,w,F,R,z,I,P,V,O],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:20px 0;width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();var ft=(()=>{let n=class n{constructor(e){this.dialogRef=e,this.resenia=""}onConfirm(){this.resenia!==""&&this.dialogRef.close({resenia:this.resenia})}onCancel(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v))},n.\u0275cmp=_({type:n,selectors:[["app-finalizar-turno-dialog"]],standalone:!0,features:[C],decls:10,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],["appearance","fill",1,"w-100"],["matInput","","placeholder","Deje un diagn\xF3stico como rese\xF1a","rows","5",3,"ngModelChange","ngModel"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Finalizar Turno"),l(),r(2,"div",1)(3,"mat-form-field",2)(4,"textarea",3),D("ngModelChange",function(h){return k(o.resenia,h)||(o.resenia=h),h}),l()()(),r(5,"div",4)(6,"button",5),m("click",function(){return o.onCancel()}),c(7,"Cancelar"),l(),r(8,"button",5),m("click",function(){return o.onConfirm()}),c(9,"Confirmar"),l()()),t&2&&(d(4),E("ngModel",o.resenia))},dependencies:[N,A,L,B,U,G,$,W,w,F,R,z,I,P,V,O],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:20px 0;width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();var gt=(()=>{let n=class n{constructor(e,t){this.dialogRef=e,this.data=t}onClose(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v),u(j))},n.\u0275cmp=_({type:n,selectors:[["app-show-motivo-rechazo-dialog"]],standalone:!0,features:[C],decls:8,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Motivo de Rechazo"),l(),r(2,"div",1)(3,"p"),c(4),l()(),r(5,"div",2)(6,"button",3),m("click",function(){return o.onClose()}),c(7,"Ok"),l()()),t&2&&(d(4),T(o.data.motivo))},dependencies:[w,F],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center;padding-top:1em}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:20px 0;height:100px}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-bottom:1em}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();var Ct=(()=>{let n=class n{constructor(e,t){this.dialogRef=e,this.data=t}onClose(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v),u(j))},n.\u0275cmp=_({type:n,selectors:[["app-show-resenia-dialog"]],standalone:!0,features:[C],decls:10,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],[1,"text-center"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Rese\xF1a"),l(),r(2,"div",1)(3,"h3",2),c(4,"Diagn\xF3stico"),l(),r(5,"p"),c(6),l()(),r(7,"div",3)(8,"button",4),m("click",function(){return o.onClose()}),c(9,"Ok"),l()()),t&2&&(d(6),T(o.data.resenia))},dependencies:[w,F],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center;padding-top:1em}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;height:100px}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-bottom:1em}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();var ht=(()=>{let n=class n{constructor(e){this.dialogRef=e,this.calificacion=""}onConfirm(){this.calificacion!=""&&this.dialogRef.close(this.calificacion)}onCancel(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v))},n.\u0275cmp=_({type:n,selectors:[["app-calificacion-encuesta-dialog"]],standalone:!0,features:[C],decls:10,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],["appearance","fill",1,"w-100"],["matInput","","placeholder","Califique a su especialista","rows","5",3,"ngModelChange","ngModel"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Encuesta"),l(),r(2,"div",1)(3,"mat-form-field",2)(4,"textarea",3),D("ngModelChange",function(h){return k(o.calificacion,h)||(o.calificacion=h),h}),l()()(),r(5,"div",4)(6,"button",5),m("click",function(){return o.onCancel()}),c(7,"Cancelar"),l(),r(8,"button",5),m("click",function(){return o.onConfirm()}),c(9,"Confirmar"),l()()),t&2&&(d(4),E("ngModel",o.calificacion))},dependencies:[N,A,L,B,U,G,$,W,w,F,R,z,I,P,V,O],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:20px 0;width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();var xt=(()=>{let n=class n{constructor(e,t){this.dialogRef=e,this.data=t}onClose(){this.dialogRef.close()}};n.\u0275fac=function(t){return new(t||n)(u(v),u(j))},n.\u0275cmp=_({type:n,selectors:[["app-show-calificacion-encuesta-dialog"]],standalone:!0,features:[C],decls:8,vars:1,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",1,"dialog-text",3,"click"]],template:function(t,o){t&1&&(r(0,"h1",0),c(1,"Calificaci\xF3n de la Encuesta"),l(),r(2,"div",1)(3,"p"),c(4),l()(),r(5,"div",2)(6,"button",3),m("click",function(){return o.onClose()}),c(7,"Ok"),l()()),t&2&&(d(4),T(o.data.calificacion))},dependencies:[w,F],styles:[".dialog-title[_ngcontent-%COMP%]{text-align:center;padding-top:1em}.dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:20px 0;height:100px}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-bottom:1em}.dialog-text[_ngcontent-%COMP%]{text-align:center}"]});let i=n;return i})();function Tt(i,n){if(i&1&&H(0,"app-spinner",3),i&2){let a=s();X("loading",a.loading)}}function vt(i,n){i&1&&(r(0,"th",7),c(1,"Especialista"),l())}function Ft(i,n){i&1&&(r(0,"th",7),c(1,"Paciente"),l())}function wt(i,n){i&1&&(r(0,"td",10),c(1,"No se encontraron resultados"),l())}function St(i,n){if(i&1){let a=x();r(0,"td",13),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.setFilter("especialista",t.especialistaId))}),c(1),l()}if(i&2){let a=s().$implicit,e=s(3);d(),T(e.userMap[a.especialistaId])}}function yt(i,n){if(i&1){let a=x();r(0,"td",13),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.setFilter("paciente",t.pacienteId))}),c(1),l()}if(i&2){let a=s().$implicit,e=s(3);d(),T(e.userMap[a.pacienteId])}}function bt(i,n){if(i&1){let a=x();r(0,"button",17),m("click",function(){f(a);let t=s(2).$implicit,o=s(3);return g(o.changeState(t,"confirmado"))}),c(1," Aceptar "),l(),r(2,"button",18),m("click",function(){f(a);let t=s(2).$implicit,o=s(3);return g(o.changeState(t,"rechazado"))}),c(3," Rechazar "),l()}}function Et(i,n){if(i&1){let a=x();r(0,"button",16),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.changeState(t,"cancelado"))}),c(1," Cancelar "),l(),S(2,bt,4,0)}if(i&2){let a=s(4);d(2),M(2,a.currentRol=="especialista"?2:-1)}}function kt(i,n){if(i&1){let a=x();r(0,"button",19),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.showMotivo(t))}),c(1," Ver motivo "),l()}}function Dt(i,n){if(i&1){let a=x();r(0,"button",19),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.showMotivo(t))}),c(1," Ver motivo "),l()}}function Rt(i,n){if(i&1){let a=x();r(0,"button",20),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.changeState(t,"finalizado"))}),c(1," Finalizar "),l()}}function It(i,n){if(i&1){let a=x();r(0,"button",20),m("click",function(){f(a);let t=s(2).$implicit,o=s(3);return g(o.completarEncuesta(t))}),c(1," Completar Encuesta "),l()}}function Pt(i,n){if(i&1){let a=x();r(0,"button",20),m("click",function(){f(a);let t=s(2).$implicit,o=s(3);return g(o.showEncuesta(t))}),c(1," Ver Calificaci\xF3n "),l()}}function Vt(i,n){if(i&1){let a=x();r(0,"button",19),m("click",function(){f(a);let t=s().$implicit,o=s(3);return g(o.showMotivo(t))}),c(1," Ver rese\xF1a "),l(),S(2,It,2,0,"button",21)(3,Pt,2,0,"button",21)}if(i&2){let a=s().$implicit,e=s(3);d(2),M(2,e.currentRol=="paciente"&&a.comentario==""?2:-1),d(),M(3,a.comentario!=""?3:-1)}}function zt(i,n){}function Ot(i,n){if(i&1){let a=x();r(0,"tr",6)(1,"td"),c(2),l(),S(3,St,2,1,"td",12)(4,yt,2,1,"td",12),r(5,"td",13),m("click",function(){let t=f(a).$implicit,o=s(3);return g(o.setFilter("especialidad",t.especialidad))}),c(6),l(),r(7,"td",14),c(8),l(),r(9,"td")(10,"div",15),S(11,Et,3,1)(12,kt,2,0)(13,Dt,2,0)(14,Rt,2,0)(15,Vt,4,2)(16,zt,0,0),l()()()}if(i&2){let a=n.$implicit,e=s(3);d(2),T(a.fecha),d(),M(3,e.currentRol!="especialista"?3:-1),d(),M(4,e.currentRol!="paciente"?4:-1),d(2),T(a.especialidad),d(2),T(a.estado),d(3),M(11,a.estado=="pendiente"?11:a.estado=="cancelado"?12:a.estado=="rechazado"?13:a.estado=="confirmado"?14:a.estado=="finalizado"&&a.resenia!=""?15:-1),d(5),M(16,a.comentario!=""||a.resenia!=""?16:-1)}}function jt(i,n){if(i&1&&Q(0,Ot,17,7,"tr",6,J),i&2){let a=s(2);Y(a.pagedTurnos)}}function At(i,n){if(i&1){let a=x();r(0,"app-listado-filtros",4),m("filterApplied",function(t){f(a);let o=s();return g(o.onFilterApplied(t))})("filtersCleared",function(){f(a);let t=s();return g(t.onFiltersCleared())}),l(),r(1,"table",5)(2,"thead")(3,"tr",6)(4,"th",7),c(5,"Fecha"),l(),S(6,vt,2,0,"th",7)(7,Ft,2,0,"th",7),r(8,"th",7),c(9,"Especialidad"),l(),r(10,"th",8),c(11,"Estado"),l(),r(12,"th",9),c(13,"Modificar Estado"),l()()(),r(14,"tbody"),S(15,wt,2,0,"td",10)(16,jt,2,0),l()(),r(17,"app-paginacion",11),m("pageChanged",function(t){f(a);let o=s();return g(o.setPage(t))}),l()}if(i&2){let a=s();X("currentRol",a.currentRol)("turnos",a.turnos)("filteredTurnos",a.filteredTurnos)("userMap",a.userMap)("especialidadFilter",a.especialidadFilter)("especialistaFilter",a.especialistaFilter)("pacienteFilter",a.pacienteFilter),d(6),M(6,a.currentRol!="especialista"?6:-1),d(),M(7,a.currentRol!="paciente"?7:-1),d(8),M(15,(a.pagedTurnos==null?null:a.pagedTurnos.length)===0?15:16),d(2),X("currentPage",a.currentPage)("totalPages",a.totalPages)}}var Mt=(()=>{let n=class n{constructor(e,t,o,p,h){this.userService=e,this.loginService=t,this.turnoService=o,this.toast=p,this.dialog=h,this.loading=!0,this.currentRol="",this.mySelf=null,this.pacientes=[],this.medicos=[],this.turnos=[],this.filteredTurnos=[],this.userMap={},this.currentPage=1,this.pageSize=10,this.especialidadFilter="",this.especialistaFilter="",this.pacienteFilter=""}ngOnInit(){this.getData()}getData(){return b(this,null,function*(){try{let e=this.loginService.getLoggedUser();if(this.mySelf=yield this.userService.getUserByEmail(e),this.currentRol=this.mySelf?.rol,this.currentRol=="paciente"?this.turnos=yield this.turnoService.getTurnosFromPaciente(e):this.currentRol=="especialista"&&(this.turnos=yield this.turnoService.getTurnosFromEspecialista(e)),this.filteredTurnos=this.turnos,this.turnos&&this.turnos.length>0)for(let t of this.turnos)this.userMap[t.especialistaId]||(this.userMap[t.especialistaId]=yield this.userService.getNameAndSurnameByEmail(t.especialistaId)),this.userMap[t.pacienteId]||(this.userMap[t.pacienteId]=yield this.userService.getNameAndSurnameByEmail(t.pacienteId))}catch(e){console.log(e)}finally{this.loading=!1}})}completarEncuesta(e){this.dialog.open(ht,{width:"400px",data:{calificacion:""}})?.afterClosed().subscribe(o=>b(this,null,function*(){o&&(e.comentario=o,yield this.turnoService.update(e))}))}showEncuesta(e){let t=e.comentario;e.estado=="finalizado"&&this.dialog.open(xt,{width:"400px",data:{calificacion:t}})}setFilter(e,t){e==="especialidad"?this.especialidadFilter=t:e==="especialista"?this.especialistaFilter=this.userMap[t]:e=="paciente"&&(this.pacienteFilter=this.userMap[t])}onFilterApplied(e){this.especialidadFilter=e.especialidadFilter,this.especialistaFilter=e.especialistaFilter,this.pacienteFilter=e.pacienteFilter,this.applyFilters()}onFiltersCleared(){this.especialidadFilter="",this.especialistaFilter="",this.filteredTurnos=this.turnos}applyFilters(){this.filteredTurnos=this.turnos?.filter(e=>{let t=this.especialidadFilter?e.especialidad.includes(this.especialidadFilter):!0,o=this.especialistaFilter?this.userMap[e.especialistaId].includes(this.especialistaFilter):!0,p=this.pacienteFilter?this.userMap[e.pacienteId].includes(this.pacienteFilter):!0;return t&&o&&p})}changeState(e,t){return b(this,null,function*(){let o=null;t=="cancelado"&&(o=this.dialog.open(ct,{width:"400px",data:{motivo:""}})),t=="rechazado"&&(o=this.dialog.open(_t,{width:"400px",data:{motivo:""}})),(t=="cancelado"||t=="rechazado")&&o?.afterClosed().subscribe(p=>b(this,null,function*(){p&&(e.estado=t,e.comentario=p,yield this.turnoService.update(e))})),t=="confirmado"&&(this.toast.success("Turno confirmado!"),e.estado=t,yield this.turnoService.update(e)),t=="finalizado"&&(o=this.dialog.open(ft,{width:"400px",data:{motivo:""}}),o?.afterClosed().subscribe(p=>b(this,null,function*(){p&&(e.estado=t,e.resenia=p.resenia,yield this.turnoService.update(e))})))})}showMotivo(e){let t=e.comentario;if(e.estado=="cancelado"&&this.dialog.open(st,{width:"400px",data:{motivo:t}}),e.estado=="rechazado"&&this.dialog.open(gt,{width:"400px",data:{motivo:t}}),e.estado=="finalizado"){let o=e.resenia;this.dialog.open(Ct,{width:"400px",data:{resenia:o}})}}get pagedTurnos(){let e=(this.currentPage-1)*this.pageSize;return this.filteredTurnos?.slice(e,e+this.pageSize)}get totalPages(){return this.filteredTurnos?Math.ceil(this.filteredTurnos.length/this.pageSize):0}setPage(e){this.currentPage=e}};n.\u0275fac=function(t){return new(t||n)(u(et),u(tt),u(lt),u(Z),u(at))},n.\u0275cmp=_({type:n,selectors:[["app-mis-turnos"]],standalone:!0,features:[C],decls:5,vars:1,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container"],[3,"loading"],[3,"filterApplied","filtersCleared","currentRol","turnos","filteredTurnos","userMap","especialidadFilter","especialistaFilter","pacienteFilter"],[1,"table","table-striped","table-light","container"],[1,"text-center"],["scope","col"],["scope","col",2,"width","120px"],["scope","col",1,"td-modify-state"],["colspan","6",1,"td-no-results"],[3,"pageChanged","currentPage","totalPages"],[1,"td-clickeable"],[1,"td-clickeable",3,"click"],[2,"width","120px"],[1,"td-modify-state"],[1,"btn","btn-dark",3,"click"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),S(3,Tt,1,1,"app-spinner",3)(4,At,18,12),l()()()),t&2&&(d(3),M(3,o.loading?3:4))},dependencies:[ot,dt,rt],styles:['.container-fluid[_ngcontent-%COMP%]{height:90vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.mt-4[_ngcontent-%COMP%]{background-color:#add8e6;height:800px}table[_ngcontent-%COMP%]{margin-top:1em}.td-modify-state[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-evenly;align-items:center}.td-clickeable[_ngcontent-%COMP%]:hover{opacity:.6;cursor:pointer}.td-no-results[_ngcontent-%COMP%]{background-color:#fff;text-align:center;font-size:medium;padding-top:1em;padding-bottom:1em}']});let i=n;return i})();var ze=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_({type:n,selectors:[["app-mis-turnos-container"]],standalone:!0,features:[C],decls:4,vars:0,consts:[[1,"container-fluid","m-0","p-0"]],template:function(t,o){t&1&&(r(0,"div",0),H(1,"app-navbar")(2,"app-mis-turnos")(3,"app-footer"),l())},dependencies:[Mt,it,nt]});let i=n;return i})();export{ze as MisTurnosContainerComponent};
