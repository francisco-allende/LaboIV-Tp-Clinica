import{a as U}from"./chunk-DEDYB2T4.js";import{a as I}from"./chunk-XVUSDMUC.js";import{a as q}from"./chunk-XSDBD7LZ.js";import{a as V,b as u,d as j,e as N,h as A,j as D,m as R,r as z,s as B,t as G}from"./chunk-FSRSBQOR.js";import{H as P,J as T}from"./chunk-UUFXAH3U.js";import"./chunk-IX6G3U3V.js";import{h as M}from"./chunk-2URDVIT7.js";import{Ab as k,Db as b,Eb as h,Mb as c,Nb as L,Sa as S,Ua as l,Va as d,Wb as O,ga as y,kb as v,mb as p,qa as C,ra as F,rb as g,sb as x,tb as E,ub as w,vb as o,wb as r,xb as m}from"./chunk-TDWWCWZI.js";import{h as f}from"./chunk-DLDOR3YA.js";function Z(t,a){t&1&&(o(0,"div"),c(1,"El correo electr\xF3nico es obligatorio."),r())}function H(t,a){t&1&&(o(0,"div"),c(1,"El correo electr\xF3nico no es v\xE1lido."),r())}function J(t,a){if(t&1&&(o(0,"div",9),v(1,Z,2,0,"div")(2,H,2,0,"div"),r()),t&2){let s=h();l(),g(1,s.loginForm.controls.email.errors!=null&&s.loginForm.controls.email.errors.required?1:-1),l(),g(2,s.loginForm.controls.email.errors!=null&&s.loginForm.controls.email.errors.email?2:-1)}}function K(t,a){t&1&&(o(0,"div",9),c(1," La contrase\xF1a debe contener al menos 8 caracteres. "),r())}function Q(t,a){if(t&1){let s=k();o(0,"button",18),b("click",function(){let n=C(s).$implicit,e=h();return F(e.easyLogin(n))}),m(1,"img",19),o(2,"span"),c(3),r()()}if(t&2){let s=a.$implicit;l(),p("src",s.mainImg,S)("alt",s.rol),l(2),L(s.rol)}}var ae=(()=>{let a=class a{constructor(i,n,e,_,$){this.fb=i,this.router=n,this.toast=e,this.loginService=_,this.userService=$,this.loading=!0,this.easyLoginUsers=[],this.goToRegister=()=>this.router.navigateByUrl("/register"),this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(8)]]})}ngOnInit(){this.getEasyLoginUsersData()}getEasyLoginUsersData(){return f(this,null,function*(){try{this.loading=!0,this.easyLoginUsers=yield this.loginService.getAllEasyLoginUsers()}catch(i){console.log(i)}finally{this.loading=!1}})}login(){return f(this,null,function*(){if(this.loginForm.valid){let i=this.loginForm.controls.email.value,n=this.loginForm.controls.password.value;(yield this.isEspecialistaAutorizadoOrOther(i))&&this.loginService.login(i,n)}})}isEspecialistaAutorizadoOrOther(i){return f(this,null,function*(){let n=!0,e=yield this.userService.getUserByEmail(i);return e.rol=="especialista"&&(n=e.estado=="habilitado"),n||this.toast.error("Siendo medico especialista, debe estar autorizado por un admin para entrar"),n})}easyLogin(i){this.loginForm.controls.email.setValue(i.email),this.loginForm.controls.password.setValue(i.password)}};a.\u0275fac=function(n){return new(n||a)(d(z),d(M),d(P),d(T),d(I))},a.\u0275cmp=y({type:a,selectors:[["app-login"]],standalone:!0,features:[O],decls:29,vars:5,consts:[[1,"container-fluid","vh-100","m-0","p-0"],[1,"row","justify-content-center","align-items-top","h-100","form-container"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-title","text-center"],[3,"formGroup"],[1,"form-group"],["type","email","placeholder","Email","formControlName","email","appAutofocus","",1,"form-control"],[1,"text-danger"],["type","password","placeholder","Contrase\xF1a","formControlName","password",1,"form-control"],[1,"login-btns"],["type","button",1,"btn","btn-success","btn-block",3,"click","disabled"],["type","button",1,"btn","btn-primary","btn-block",3,"click"],[1,"line"],[3,"loading"],["role","group",1,"btn-easy-login","text-center"],["type","button",1,"btn","btn-outline-primary"],["type","button",1,"btn","btn-outline-primary",3,"click"],["width","80px","height","80px",1,"btn-image",3,"src","alt"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),c(6,"Ingrese su usuario"),r(),m(7,"br"),o(8,"form",6)(9,"div",7),m(10,"input",8),v(11,J,3,2,"div",9),r(),o(12,"div",7),m(13,"input",10),v(14,K,2,0,"div",9),r(),o(15,"div",11)(16,"div",7)(17,"button",12),b("click",function(){return e.login()}),c(18,"Iniciar Sesi\xF3n"),r()(),o(19,"div",7)(20,"button",13),b("click",function(){return e.goToRegister()}),c(21,"Registrarse"),r()(),m(22,"div",14),o(23,"h2"),c(24,"Acceso R\xE1pido"),r(),m(25,"app-spinner",15),o(26,"div",16),E(27,Q,4,3,"button",17,x),r()()()()()()()()),n&2&&(l(8),p("formGroup",e.loginForm),l(3),g(11,e.loginForm.controls.email.invalid&&(e.loginForm.controls.email.dirty||e.loginForm.controls.email.touched)?11:-1),l(3),g(14,e.loginForm.controls.password.invalid&&(e.loginForm.controls.password.dirty||e.loginForm.controls.password.touched)?14:-1),l(3),p("disabled",e.loginForm.invalid),l(8),p("loading",e.loading),l(2),w(e.easyLoginUsers))},dependencies:[B,A,V,j,N,G,D,R,U,q],styles:['.container-fluid[_ngcontent-%COMP%]{background-color:#000;background-image:url("./media/fondo-celeste-V4ENMZBO.png");background-size:250px 250px;background-repeat:repeat;background-position:center;display:flex;flex-direction:column;align-items:center;padding:20px;margin:1%}.form-container[_ngcontent-%COMP%]{margin-top:5em;justify-content:center;width:800px}.form-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:1em}.card-body[_ngcontent-%COMP%]{padding:2em}.login-btns[_ngcontent-%COMP%]{text-align:center}h1[_ngcontent-%COMP%]{margin-top:1em}.btn-block[_ngcontent-%COMP%]{margin-top:1em;width:200px}.btn[_ngcontent-%COMP%]{border-radius:0!important}.btn-easy-login[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn-outline-primary[_ngcontent-%COMP%]{margin:.3em;width:120px}h2[_ngcontent-%COMP%]{color:#3d8282}.line[_ngcontent-%COMP%]{width:100%;height:1px;background-color:#3d8282;margin-top:1em;margin-bottom:1em}']});let t=a;return t})();export{ae as LoginComponent};
