import{a as K}from"./chunk-7MA7VR3Q.js";import{a as q}from"./chunk-NP2AXQHK.js";import{p as X}from"./chunk-SSCLPC2F.js";import"./chunk-TAME4DBA.js";import{a as B,b as Z}from"./chunk-SCZ67AR2.js";import{a as z,b as N}from"./chunk-PAXTVJSM.js";import"./chunk-XE5KUILY.js";import"./chunk-RCHQO65C.js";import"./chunk-MT3VMLBQ.js";import"./chunk-3PKXA2GJ.js";import"./chunk-XCRSOGC7.js";import{$a as O,Ab as s,Bb as C,Eb as E,Hb as b,Ib as g,Lb as H,Rb as c,Sb as _,Ya as P,_a as m,_b as U,e as Q,f as ee,h as F,na as y,pb as k,rb as M,vb as w,wb as j,xa as h,xb as A,ya as v,yb as R,zb as r}from"./chunk-EWRZD5YS.js";var G=Q(($,D)=>{"use strict";(function(d,l){typeof define=="function"&&define.amd?define([],l):typeof $<"u"?l():(l(),d.FileSaver={})})($,function(){"use strict";function d(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function l(a,t,f){var e=new XMLHttpRequest;e.open("GET",a),e.responseType="blob",e.onload=function(){x(e.response,t,f)},e.onerror=function(){console.error("could not download file")},e.send()}function n(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function o(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,u=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(a,t,f){var e=i.URL||i.webkitURL,p=document.createElement("a");t=t||a.name||"download",p.download=t,p.rel="noopener",typeof a=="string"?(p.href=a,p.origin===location.origin?o(p):n(p.href)?l(a,t,f):o(p,p.target="_blank")):(p.href=e.createObjectURL(a),setTimeout(function(){e.revokeObjectURL(p.href)},4e4),setTimeout(function(){o(p)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,f){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(d(a,f),t);else if(n(a))l(a,t,f);else{var e=document.createElement("a");e.href=a,e.target="_blank",setTimeout(function(){o(e)})}}:function(a,t,f,e){if(e=e||open("","_blank"),e&&(e.document.title=e.document.body.innerText="downloading..."),typeof a=="string")return l(a,t,f);var p=a.type==="application/octet-stream",J=/constructor/i.test(i.HTMLElement)||i.safari,I=/CriOS\/[\d]+/.test(navigator.userAgent);if((I||p&&J||u)&&typeof FileReader<"u"){var L=new FileReader;L.onloadend=function(){var S=L.result;S=I?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),e?e.location.href=S:location=S,e=null},L.readAsDataURL(a)}else{var V=i.URL||i.webkitURL,T=V.createObjectURL(a);e?e.location=T:location.href=T,e=null,setTimeout(function(){V.revokeObjectURL(T)},4e4)}});i.saveAs=x.saveAs=x,typeof D<"u"&&(D.exports=x)})});var W=ee(G());function ne(d,l){if(d&1&&C(0,"img",11),d&2){let n=g().$implicit;M("src",n.extraImg,P)}}function ie(d,l){d&1&&c(0," - ")}function oe(d,l){if(d&1){let n=E();r(0,"button",15),b("click",function(){h(n);let i=g().$implicit,u=g(2);return v(u.changeState(i,"habilitado"))}),c(1," Habilitar "),s()}}function ae(d,l){if(d&1){let n=E();r(0,"button",16),b("click",function(){h(n);let i=g().$implicit,u=g(2);return v(u.changeState(i,"deshabilitado"))}),c(1," Desabilitar "),s()}}function re(d,l){if(d&1){let n=E();r(0,"button",17),b("click",function(){h(n);let i=g().$implicit,u=g(2);return v(u.verHistoriaClinica(i))}),c(1," Hist. Clinica "),s()}}function se(d,l){if(d&1&&(r(0,"tr",5)(1,"td"),C(2,"img",11),s(),r(3,"td"),k(4,ne,1,1,"img",11)(5,ie,1,0),s(),r(6,"td"),c(7),s(),r(8,"td"),c(9),s(),r(10,"td"),c(11),s(),r(12,"td"),c(13),s(),r(14,"td"),c(15),s(),r(16,"td"),c(17),s(),r(18,"td"),c(19),s(),r(20,"td"),c(21),s(),r(22,"td",12),k(23,oe,2,0,"button",13)(24,ae,2,0)(25,re,2,0,"button",14),s()()),d&2){let n=l.$implicit;m(2),H("src",n.mainImg,P),m(2),w(4,n.extraImg?4:5),m(3),_(n.nombre),m(2),_(n.apellido),m(2),_(n.dni),m(2),_(n.email),m(2),_(n.rol),m(2),_(n.obraSocial?n.obraSocial:"-"),m(2),_(n.especialidad?n.especialidad:"-"),m(2),_(n.estado),m(2),w(23,n.estado=="pendiente"||n.estado=="deshabilitado"?23:n.estado=="habilitado"?24:-1),m(2),w(25,n.rol=="paciente"?25:-1)}}function le(d,l){if(d&1){let n=E();r(0,"table",4)(1,"thead")(2,"tr",5)(3,"th",6),c(4,"Imagen perfil"),s(),r(5,"th",6),c(6,"Imagen extra"),s(),r(7,"th",6),c(8,"Nombre"),s(),r(9,"th",6),c(10,"Apellido"),s(),r(11,"th",6),c(12,"DNI"),s(),r(13,"th",6),c(14,"Email"),s(),r(15,"th",6),c(16,"Rol"),s(),r(17,"th",6),c(18,"Obra social"),s(),r(19,"th",6),c(20,"Especialidad"),s(),r(21,"th",7),c(22,"Estado"),s(),r(23,"th",8),c(24,"Acciones"),s()()(),r(25,"tbody"),A(26,se,26,12,"tr",5,j),s()(),r(28,"button",9),b("click",function(){h(n);let i=g();return v(i.exportToCSV())}),c(29,"Exportar a CSV"),s(),r(30,"app-paginacion",10),b("pageChanged",function(i){h(n);let u=g();return v(u.setPage(i))}),s()}if(d&2){let n=g();m(26),R(n.pagedUsers),m(4),M("currentPage",n.currentPage)("totalPages",n.totalPages)}}var Y=(()=>{let l=class l{constructor(o,i){this.usersService=o,this.dialog=i,this.users=[],this.loading=!0,this.currentPage=1,this.pageSize=9}ngOnInit(){this.getData()}getData(){return F(this,null,function*(){try{this.users=yield this.usersService.getAllUsers()}catch(o){console.log(o)}finally{this.loading=!1}})}changeState(o,i){return F(this,null,function*(){o.estado=i,yield this.usersService.update(o)})}get pagedUsers(){let o=(this.currentPage-1)*this.pageSize;return this.users?.slice(o,o+this.pageSize)}get totalPages(){return this.users?Math.ceil(this.users.length/this.pageSize):0}setPage(o){this.currentPage=o}verHistoriaClinica(o){this.dialog.open(K,{width:"600px",data:o.historiaClinica})}exportToCSV(){let x=["nombre,apellido,edad,dni,email,rol,obraSocial,especialidad,estado",...(e=>e.map(p=>({nombre:p.nombre||"-",apellido:p.apellido||"-",edad:p.edad||"-",dni:p.dni||"-",email:p.email||"-",rol:p.rol||"-",obraSocial:p.obraSocial||"-",especialidad:p.especialidad?p.especialidad.join(", "):"-",estado:p.estado||"-"})))(this.users).map(e=>`${e.nombre},${e.apellido},${e.edad},${e.dni},${e.email},${e.rol},${e.obraSocial},${e.especialidad},${e.estado}`)].join(`
`),a=new Blob([x],{type:"text/csv;charset=utf-8"}),t=new Date,f=`Usuarios_Clinica_San_Lucas_${t.getFullYear()}-${this.padZero(t.getMonth()+1)}-${this.padZero(t.getDate())}_${this.padZero(t.getHours())}-${this.padZero(t.getMinutes())}-${this.padZero(t.getSeconds())}`;W.saveAs(a,`${f}.csv`)}padZero(o){return o<10?`0${o}`:`${o}`}};l.\u0275fac=function(i){return new(i||l)(O(z),O(X))},l.\u0275cmp=y({type:l,selectors:[["app-listado-usuarios"]],standalone:!0,features:[U],decls:5,vars:2,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container"],[3,"loading"],[1,"table","table-striped","table-light","container"],[1,"text-center"],["scope","col"],["scope","col",2,"width","112px"],["scope","col",2,"width","412px"],[1,"btn","btn-success","btn-csv",3,"click"],[3,"pageChanged","currentPage","totalPages"],["width","50px","height","50px",3,"src"],[1,"d-flex","justify-content-evenly","align-items-center","action-btns"],[1,"btn","btn-success","enabled"],[1,"btn","btn-dark","text-center"],[1,"btn","btn-success","enabled",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-dark","text-center",3,"click"]],template:function(i,u){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),C(3,"app-spinner",3),k(4,le,31,2),s()()()),i&2&&(m(3),M("loading",u.loading),m(),w(4,u.loading?-1:4))},dependencies:[N,q],styles:['.container-fluid[_ngcontent-%COMP%]{height:90vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.mt-4[_ngcontent-%COMP%]{background-color:#add8e6;height:800px}table[_ngcontent-%COMP%]{margin-top:1em}li[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:hover{cursor:pointer}.btn-danger[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.btn-danger[_ngcontent-%COMP%], .btn-dark[_ngcontent-%COMP%], .enabled[_ngcontent-%COMP%]{height:40px;border-radius:0!important;width:90px}.btn-dark[_ngcontent-%COMP%]{font-size:small;padding-left:.1em;padding-right:.1em}.action-btns[_ngcontent-%COMP%]{padding:.2em;height:67.5px}.btn-csv[_ngcontent-%COMP%]{margin-bottom:1em}']});let d=l;return d})();var Se=(()=>{let l=class l{};l.\u0275fac=function(i){return new(i||l)},l.\u0275cmp=y({type:l,selectors:[["app-usuarios-container"]],standalone:!0,features:[U],decls:4,vars:0,consts:[[1,"container-fluid","m-0","p-0"]],template:function(i,u){i&1&&(r(0,"div",0),C(1,"app-navbar")(2,"app-listado-usuarios")(3,"app-footer"),s())},dependencies:[Y,B,Z]});let d=l;return d})();export{Se as UsuariosContainerComponent};
