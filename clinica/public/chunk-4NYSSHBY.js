import{a as Z}from"./chunk-S5EKIQAW.js";import{a as M}from"./chunk-GSNWQ4FR.js";import{a as L}from"./chunk-AT26J2S3.js";import{a as x}from"./chunk-QHILSBCE.js";import{c as C}from"./chunk-WB4RW6JM.js";import{a as O,b as E}from"./chunk-XS3MNTZJ.js";import"./chunk-ZHVU5HJQ.js";import"./chunk-CC3LA27V.js";import"./chunk-7XIEKY6O.js";import{a as I}from"./chunk-4YPGSVQN.js";import{P as k}from"./chunk-KOE6HBMH.js";import"./chunk-IX6G3U3V.js";import"./chunk-2URDVIT7.js";import{Db as v,Ib as w,Jb as F,Kb as P,Mb as g,Ua as S,Va as h,Wb as f,ga as m,mb as _,vb as d,wb as l,xb as b}from"./chunk-TDWWCWZI.js";import"./chunk-FK6H3RFT.js";import{f as V,h as $}from"./chunk-DLDOR3YA.js";var j=V(Z());var B=(()=>{let n=class n{constructor(t){this.loginServicve=t,this.logs=[]}ngOnInit(){this.getData()}getData(){return $(this,null,function*(){this.logs=yield this.loginServicve.getAllLogs()})}descargarCSV(){let a=["fecha,userEmail",...this.getCSVFormatData()(this.logs).map(r=>`${r.fecha},${r.userEmail}`)];j.saveAs(this.getBlob(a),`${this.getFileName()}.csv`)}getCSVFormatData(){return t=>t.map(e=>({fecha:this.getFormattedDate(e.fecha)||"-",userEmail:e.userEmail||"-"}))}getFormattedDate(t){let e=new Date(t.toDate()),a=e.getDate(),r=e.getMonth()+1,i=e.getFullYear(),s=e.getHours(),u=e.getMinutes(),c=e.getSeconds(),p=a<10?`0${a}`:a,D=r<10?`0${r}`:r,y=s<10?`0${s}`:s,N=u<10?`0${u}`:u,Q=c<10?`0${c}`:c;return`${p}/${D}/${i} ${y}:${N}:${Q}`}getFileName(){let t=new Date;return`Logs_Clinica_San_Francisco_${t.getFullYear()}-${this.padZero(t.getMonth()+1)}-${this.padZero(t.getDate())}_${this.padZero(t.getHours())}-${this.padZero(t.getMinutes())}-${this.padZero(t.getSeconds())}`}getBlob(t){let e=t.join(`
`);return new Blob([e],{type:"text/csv;charset=utf-8"})}padZero(t){return t<10?`0${t}`:`${t}`}};n.\u0275fac=function(e){return new(e||n)(h(I))},n.\u0275cmp=m({type:n,selectors:[["app-logs"]],standalone:!0,features:[f],decls:7,vars:0,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container",2,"background-color","white"],[1,"btn","btn-success",3,"click"]],template:function(e,a){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),v("click",function(){return a.descargarCSV()}),d(4,"mat-icon"),g(5,"download"),l(),g(6," Descargar Logs"),l()()()())},dependencies:[L],styles:['.container-fluid[_ngcontent-%COMP%]{height:85vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.mt-4[_ngcontent-%COMP%]{height:800px}']});let o=n;return o})();var A=(()=>{let n=class n{constructor(t,e){this.toast=t,this.turnosService=e,this.barChartLabels=[],this.barChartData=[{data:[],label:"Cantidad de Turnos seg\xFAn especialidad"}],this.barChartOptions={responsive:!0,width:"400px",height:"200px",backgroundColor:"#0cb7f2"},this.turnos=[]}ngOnInit(){this.turnosService.getAllTurnos().subscribe(t=>{this.turnos=t,this.filterData()})}filterData(){let t=this.turnos.reduce((e,a)=>(a.especialidad&&(e[a.especialidad]=(e[a.especialidad]||0)+1),e),{});this.updateChart(t)}updateChart(t){let e=Object.entries(t).sort((a,r)=>a[1]-r[1]);this.barChartLabels=e.map(a=>a[0]),this.barChartData=[{data:e.map(a=>a[1]),label:"Cantidad de Turnos seg\xFAn especialidad"}]}downloadPDF(){try{let t=new M,e=this.chart?.toBase64Image();e?(t.addImage(e,"PNG",10,10,180,160),t.save("grafico_turnos_por_especialidad.pdf")):this.toast.error("No se puedo descargar el PDF")}catch(t){console.log(t)}}};n.\u0275fac=function(e){return new(e||n)(h(k),h(x))},n.\u0275cmp=m({type:n,selectors:[["app-graf-turnos-por-especialidad"]],viewQuery:function(e,a){if(e&1&&w(C,5),e&2){let r;F(r=P())&&(a.chart=r.first)}},standalone:!0,features:[f],decls:7,vars:3,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container","graph-container"],["baseChart","","type","bar",3,"datasets","labels","options"],[1,"btn","btn-success","btn-pdf",3,"click"]],template:function(e,a){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2),b(3,"canvas",3)(4,"br"),d(5,"button",4),v("click",function(){return a.downloadPDF()}),g(6,"Descargar"),l()()()()),e&2&&(S(3),_("datasets",a.barChartData)("labels",a.barChartLabels)("options",a.barChartOptions))},dependencies:[C],styles:['.container-fluid[_ngcontent-%COMP%]{height:85vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.graph-container[_ngcontent-%COMP%]{background-color:#fff;padding-bottom:1em}.mt-4[_ngcontent-%COMP%]{height:800px}.btn-pdf[_ngcontent-%COMP%]{margin-top:1em}']});let o=n;return o})();var G=(()=>{let n=class n{constructor(t,e){this.toast=t,this.turnosService=e,this.barChartLabels=[],this.barChartData=[{data:[],label:"Cantidad de Turnos por d\xEDa"}],this.barChartOptions={responsive:!0,width:"400px",height:"200px",backgroundColor:"#ffa420",fill:!0},this.turnos=[]}ngOnInit(){this.turnosService.getAllTurnos().subscribe(t=>{this.turnos=t,this.filterData()})}filterData(){let t={};this.turnos.forEach(e=>{let a=e.fecha.fecha,r=e.fecha.dayName;t[r]||(t[r]=[]);let i=t[r].find(s=>s.fecha===a);i?i.cantidad++:t[r].push({fecha:a,cantidad:1})}),this.updateChart(t)}order(t,e){let a=/^(\d{2})-(\d{2})-(\d{4})$/,r=t.match(a),i=r?parseInt(r[1],10):0,s=r?parseInt(r[2],10):0,u=r?parseInt(r[3],10):0,c=e.match(a),p=c?parseInt(c[1],10):0,D=c?parseInt(c[2],10):0,y=c?parseInt(c[3],10):0;return u!==y?u-y:s!==D?s-D:i-p}updateChart(t){let e=new Set,a=Object.entries(t).map(([i,s])=>{let u=s.map(p=>p.fecha),c=s.map(p=>p.cantidad);return s.forEach(p=>e.add(p.fecha)),{labels:u,data:c}}),r=Array.from(e).sort((i,s)=>this.order(i,s));this.barChartLabels=r,this.barChartData=[{data:this.fillDataWithZero(r,a.flatMap(i=>i.data),r),label:"Turnos por d\xEDa"}]}fillDataWithZero(t,e,a){return a.map(r=>{let i=t.indexOf(r);return i!==-1?e[i]:0})}downloadPDF(){try{let t=new M,e=this.chart?.toBase64Image();e?(t.addImage(e,"PNG",10,10,180,160),t.save("grafico_turnos_por_dia.pdf")):this.toast.error("No se puedo descargar el PDF")}catch(t){console.log(t)}}};n.\u0275fac=function(e){return new(e||n)(h(k),h(x))},n.\u0275cmp=m({type:n,selectors:[["app-graph-turnos-por-dia"]],viewQuery:function(e,a){if(e&1&&w(C,5),e&2){let r;F(r=P())&&(a.chart=r.first)}},standalone:!0,features:[f],decls:7,vars:3,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container","graph-container"],["baseChart","","type","bar",3,"datasets","labels","options"],[1,"btn","btn-success","btn-pdf",3,"click"]],template:function(e,a){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2),b(3,"canvas",3)(4,"br"),d(5,"button",4),v("click",function(){return a.downloadPDF()}),g(6,"Descargar"),l()()()()),e&2&&(S(3),_("datasets",a.barChartData)("labels",a.barChartLabels)("options",a.barChartOptions))},dependencies:[C],styles:['.container-fluid[_ngcontent-%COMP%]{height:85vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.graph-container[_ngcontent-%COMP%]{background-color:#fff;padding-bottom:1em}.mt-4[_ngcontent-%COMP%]{height:800px}.btn-pdf[_ngcontent-%COMP%]{margin-top:1em}']});let o=n;return o})();var it=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=m({type:n,selectors:[["app-graficos-container"]],standalone:!0,features:[f],decls:6,vars:0,consts:[[1,"container-fluid","m-0","p-0"]],template:function(e,a){e&1&&(d(0,"div",0),b(1,"app-navbar")(2,"app-graf-turnos-por-especialidad")(3,"app-graph-turnos-por-dia")(4,"app-logs")(5,"app-footer"),l())},dependencies:[B,G,O,E,A]});let o=n;return o})();export{it as GraficosContainerComponent};
