import{a as _e,b as ge}from"./chunk-W57UCMC7.js";import{a as xe,b as L}from"./chunk-AZTL4HB5.js";import"./chunk-ZGC33XT2.js";import{a as z,b as W}from"./chunk-E4VBJUJN.js";import"./chunk-GSNWQ4FR.js";import"./chunk-AT26J2S3.js";import{a as he}from"./chunk-6ODF7MUU.js";import{b as re,c as le}from"./chunk-TEBHIWMK.js";import{a as se}from"./chunk-DEDYB2T4.js";import{a as ae}from"./chunk-NDYST4XC.js";import{a as j,c as U}from"./chunk-HUVKKSNT.js";import{h as k,i as V,j as ue,k as R,l as A,m as B,n as N}from"./chunk-KIGVSZDZ.js";import"./chunk-CC3LA27V.js";import"./chunk-7XIEKY6O.js";import{d as me,g as de,n as ce,o as pe,p as fe,s as P}from"./chunk-FSRSBQOR.js";import{H as I,J as oe}from"./chunk-6SOKX3XS.js";import"./chunk-IX6G3U3V.js";import"./chunk-2URDVIT7.js";import{Ab as T,Db as g,Eb as p,Mb as m,Nb as F,Ob as O,Pb as te,Sa as $,Sb as K,Tb as X,Ua as s,Ub as q,Va as f,Wb as M,Zb as x,_b as y,ga as C,kb as u,mb as d,qa as v,ra as S,rb as _,sb as D,tb as b,tc as ie,ub as E,uc as ne,vb as a,wb as o,wc as H,xb as c,za as ee}from"./chunk-TDWWCWZI.js";import"./chunk-FK6H3RFT.js";import{f as Q,h as Z}from"./chunk-DLDOR3YA.js";var w=Q(xe());function Ee(i,r){if(i&1&&(a(0,"option",12),m(1),x(2,"horariosAmPmFormat"),o()),i&2){let t=r.$implicit;d("value",t),s(),F(y(2,2,t))}}function Te(i,r){if(i&1&&(a(0,"option",12),m(1),x(2,"horariosAmPmFormat"),o()),i&2){let t=r.$implicit;d("value",t),s(),F(y(2,2,t))}}function He(i,r){if(i&1){let t=T();a(0,"tr")(1,"td",8),c(2,"input",9),x(3,"translateDayName"),o(),a(4,"td",8),c(5,"input",9),x(6,"setFechaWithSlashes"),o(),a(7,"td",8)(8,"select",10),q("ngModelChange",function(e){let l=v(t).$implicit;return X(l.desde,e)||(l.desde=e),S(e)}),u(9,Ee,3,4,"option",11),o()(),a(10,"td",8)(11,"select",10),q("ngModelChange",function(e){let l=v(t).$implicit;return X(l.hasta,e)||(l.hasta=e),S(e)}),u(12,Te,3,4,"option",11),o()()()}if(i&2){let t=r.$implicit,n=p(2);s(2),d("value",y(3,6,t.dayName)),s(3),d("value",y(6,8,t.fecha)),s(3),K("ngModel",t.desde),s(),d("ngForOf",n.validTimes),s(2),K("ngModel",t.hasta),s(),d("ngForOf",n.validTimes)}}function Ie(i,r){if(i&1&&b(0,He,13,10,"tr",null,D),i&2){let t=p();E(t.daysData)}}var ve=(()=>{let r=class r{constructor(n,e,l){this.dialogRef=n,this.data=e,this.toast=l,this.serviceHoursUpdated=new ee,this.daysData=[],this.validTimes=[]}ngOnInit(){this.data&&this.data.daysData&&(this.daysData=this.data.daysData,this.generateDaysData(),this.generateValidTimes())}generateDaysData(){let n=(0,w.default)();this.daysData=[];for(let e=0;e<15;e++){let l=n.clone().add(e,"days");this.daysData.push({dayName:l.format("dddd"),desde:"",hasta:"",fecha:l.format("DD-MM-YYYY"),estaDisponible:!0,timeSlot:{time:"",estaDisponible:!0}})}}generateValidTimes(){let n=(0,w.default)("07:00","HH:mm"),e=(0,w.default)("18:00","HH:mm");for(this.validTimes.push("");n<=e;)this.validTimes.push(n.format("HH:mm")),n.add(30,"minutes")}actualizarHorarios(){this.isValid()&&(this.serviceHoursUpdated.emit(this.daysData),this.dialogRef.close(this.daysData))}isValid(){let n=!0;return this.daysData.forEach(e=>{if(e.desde!=""&&e.hasta==""&&(this.toast.error("Todo rango de turnos necesita un horario de inicio y finalizaci\xF3n completos"),n=!1),e.hasta!=""&&e.desde==""&&(this.toast.error("Todo rango de turnos necesita un desde y hasta completo"),n=!1),e.desde!==""&&e.hasta!==""){let l=(0,w.default)(e.desde,"HH:mm"),h=(0,w.default)(e.hasta,"HH:mm");l.isAfter(h)&&(this.toast.error("El horario de inicio no puede ser posterior al horario de finalizaci\xF3n"),n=!1),e.desde===e.hasta&&(this.toast.error("Todo rango de turnos necesita un horario de inicio y finalizaci\xF3n completos"),n=!1)}}),n}onCancel(){this.dialogRef.close()}};r.\u0275fac=function(e){return new(e||r)(f(k),f(V),f(I))},r.\u0275cmp=C({type:r,selectors:[["app-modal-horarios"]],outputs:{serviceHoursUpdated:"serviceHoursUpdated"},standalone:!0,features:[M],decls:23,vars:1,consts:[["mat-dialog-title","",1,"text-center"],["mat-dialog-content",""],[1,"text-center"],[1,"table","text-center"],["scope","col"],["mat-dialog-actions","",1,"d-flex","justify-content-evenly"],["mat-button","",1,"btn","btn-danger",3,"click"],["mat-button","",1,"btn","btn-success",3,"click"],[1,"align-middle"],["type","text","readonly","",1,"short-input",3,"value"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,l){e&1&&(a(0,"h1",0),m(1,"Horario disponibles de atenci\xF3n"),o(),a(2,"div",1)(3,"p",2),m(4,"Elija su horario de atenci\xF3n, de 07:00 a 18:00"),o(),a(5,"table",3)(6,"thead")(7,"tr")(8,"th",4),m(9,"D\xEDa"),o(),a(10,"th",4),m(11,"Fecha"),o(),a(12,"th",4),m(13,"Desde"),o(),a(14,"th",4),m(15,"Hasta"),o()()(),a(16,"tbody"),u(17,Ie,2,0),o()()(),a(18,"div",5)(19,"button",6),g("click",function(){return l.onCancel()}),m(20,"Cancelar"),o(),a(21,"button",7),g("click",function(){return l.actualizarHorarios()}),m(22,"Guardar"),o()()),e&2&&(s(17),_(17,l.daysData.length==15?17:-1))},dependencies:[P,pe,fe,ce,me,de,H,ie,N,R,B,A,U,j,L,W,z],styles:[".btn[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff}.short-input[_ngcontent-%COMP%]{width:100px}"]});let i=r;return i})();var Y=Q(xe());function Pe(i,r){if(i&1&&(a(0,"tr")(1,"td",7),c(2,"input",8),x(3,"translateDayName"),o(),a(4,"td",7),c(5,"input",8),x(6,"setFechaWithSlashes"),o(),a(7,"td",7),c(8,"input",8),x(9,"horariosAmPmFormat"),o(),a(10,"td",7),c(11,"input",8),o()()),i&2){let t=p().$implicit;s(2),d("value",y(3,4,t.dayName)),s(3),d("value",y(6,6,t.fecha)),s(3),d("value",y(9,8,t.desde)),s(3),d("value",t.hasta)}}function we(i,r){i&1&&(a(0,"tr",9)(1,"td",7),c(2,"input",10),o(),a(3,"td",7),c(4,"input",10),o(),a(5,"td",7),c(6,"input",10),o(),a(7,"td",7),c(8,"input",10),o()()),i&2&&(s(2),d("value","-"),s(2),d("value","-/-/-"),s(2),d("value","--:--"),s(2),d("value","--:--"))}function Fe(i,r){if(i&1&&u(0,Pe,12,10,"tr")(1,we,9,4),i&2){let t=r.$implicit;_(0,t.desde!=""&&t.hasta!=""?0:1)}}function Oe(i,r){if(i&1&&b(0,Fe,2,1,null,null,D),i&2){let t=p();E(t.daysData)}}var Se=(()=>{let r=class r{constructor(n,e,l){this.dialogRef=n,this.data=e,this.toast=l,this.daysData=[],this.daysData=e.daysData}onCancel(){this.dialogRef.close()}};r.\u0275fac=function(e){return new(e||r)(f(k),f(V),f(I))},r.\u0275cmp=C({type:r,selectors:[["app-ver-modal-horarios"]],standalone:!0,features:[M],decls:21,vars:1,consts:[["mat-dialog-title","",1,"text-center"],["mat-dialog-content",""],[1,"text-center"],[1,"table","text-center"],["scope","col"],["mat-dialog-actions","",1,"d-flex","justify-content-evenly"],["mat-button","",1,"btn","btn-primary",3,"click"],[1,"align-middle"],["type","text","readonly","",1,"short-input",3,"value"],[1,"non-chosen"],["type","text","readonly","",1,"short-input","text-center",3,"value"]],template:function(e,l){e&1&&(a(0,"h1",0),m(1,"Horario elegidos de atenci\xF3n"),o(),a(2,"div",1)(3,"p",2),m(4,"Los horarios de atenci\xF3n son de 07:00 a 18:00"),o(),a(5,"table",3)(6,"thead")(7,"tr")(8,"th",4),m(9,"D\xEDa"),o(),a(10,"th",4),m(11,"Fecha"),o(),a(12,"th",4),m(13,"Desde"),o(),a(14,"th",4),m(15,"Hasta"),o()()(),a(16,"tbody"),u(17,Oe,2,0),o()()(),a(18,"div",5)(19,"button",6),g("click",function(){return l.onCancel()}),m(20,"Ok"),o()()),e&2&&(s(17),_(17,l.daysData.length==15?17:-1))},dependencies:[P,H,N,R,B,A,U,j,L,W,z],styles:[".non-chosen[_ngcontent-%COMP%]{text-align:center;opacity:.3}.btn[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff}.short-input[_ngcontent-%COMP%]{width:100px}"]});let i=r;return i})();function ke(i,r){if(i&1&&c(0,"app-spinner",3),i&2){let t=p();d("loading",t.loading)}}function Ve(i,r){if(i&1){let t=T();a(0,"div"),c(1,"img",9),a(2,"button",10),g("click",function(){v(t);let e=p(2);return S(e.toggleImage())}),m(3,"Cambiar Imagen"),o()()}if(i&2){let t=p(2);s(),d("src",t.selectedImage,$)}}function Re(i,r){if(i&1&&(a(0,"div"),c(1,"img",9),o()),i&2){let t=p(2);s(),d("src",t.mySelf==null?null:t.mySelf.mainImg,$)}}function Ae(i,r){if(i&1&&(a(0,"p",7)(1,"strong"),m(2,"Obra Social:"),o(),m(3),o()),i&2){let t=p(2);s(3),O(" ",t.mySelf==null?null:t.mySelf.obraSocial,"")}}function Be(i,r){if(i&1&&(a(0,"li",12),m(1),o()),i&2){let t=r.$implicit;s(),F(t)}}function Ne(i,r){if(i&1){let t=T();a(0,"p",11)(1,"strong"),m(2,"Especialidades:"),o(),b(3,Be,2,1,"li",12,D),o(),a(5,"button",13),g("click",function(){v(t);let e=p(2);return S(e.verHorarios())}),m(6,"Ver mis horarios"),o(),a(7,"button",13),g("click",function(){v(t);let e=p(2);return S(e.openModal())}),m(8,"Gestionar mis horarios"),o()}if(i&2){let t=p(2);s(3),E(t.mySelf==null?null:t.mySelf.especialidad)}}function je(i,r){if(i&1){let t=T();a(0,"button",14),g("click",function(){v(t);let e=p(2);return S(e.verHistoriaClinica(e.mySelf))}),m(1," Ver Historia Clinica "),o()}}function Ue(i,r){if(i&1&&(a(0,"div",4),u(1,Ve,4,1,"div",5)(2,Re,2,1,"div",5),a(3,"div",6)(4,"p",7)(5,"strong"),m(6,"Usuario:"),o(),m(7),o(),a(8,"p",7)(9,"strong"),m(10,"DNI:"),o(),m(11),o(),a(12,"p",7)(13,"strong"),m(14,"Email:"),o(),m(15),o(),a(16,"p",7)(17,"strong"),m(18,"Rol:"),o(),m(19),o(),u(20,Ae,4,1,"p",7)(21,Ne,9,0)(22,je,2,0,"button",8),o()()),i&2){let t=p();s(),d("ngIf",t.currentRol==="paciente"),s(),d("ngIf",t.currentRol!=="paciente"),s(5),te(" ",t.mySelf==null?null:t.mySelf.nombre," ",t.mySelf==null?null:t.mySelf.apellido,""),s(4),O(" ",t.mySelf==null?null:t.mySelf.dni," "),s(4),O(" ",t.mySelf==null?null:t.mySelf.email,""),s(4),O(" ",t.mySelf==null?null:t.mySelf.rol,""),s(),_(20,t.currentRol=="paciente"?20:-1),s(),_(21,t.currentRol=="especialista"?21:-1),s(),_(22,t.currentRol=="paciente"?22:-1)}}var Me=(()=>{let r=class r{constructor(n,e,l,h,G){this.userService=n,this.loginService=e,this.turnoService=l,this.toast=h,this.dialog=G,this.loading=!0,this.currentRol="",this.mySelf=null,this.daysData=[],this.selectedImage=""}ngOnInit(){this.getData()}getData(){return Z(this,null,function*(){try{let n=this.loginService.getLoggedUser();this.mySelf=yield this.userService.getUserByEmail(n),this.selectedImage=this.mySelf?.mainImg,this.currentRol=this.mySelf?.rol,this.generateDaysData(),this.currentRol=="especialista"&&(this.daysData=this.daysData)}catch(n){console.log(n)}finally{this.loading=!1}})}toggleImage(){this.selectedImage=this.selectedImage===this.mySelf?.mainImg?this.mySelf?.extraImg:this.mySelf?.mainImg}openModal(){let n=!1;this.mySelf?.horarios?.forEach(l=>{l.dayName!=""&&l.fecha!=""&&l.desde!=""&&l.hasta!=""&&(n=!0)}),this.dialog.open(ve,{width:"600px",data:{daysData:n?this.mySelf?.horarios:this.daysData}}).afterClosed().subscribe(l=>{l&&(this.daysData=l,this.saveHorarios())})}verHorarios(){let n=this.mySelf?.horarios;this.dialog.open(Se,{width:"600px",data:{daysData:n}})}generateDaysData(){let n=(0,Y.default)();this.daysData=[];for(let e=0;e<15;e++){let l=n.clone().add(e,"days");this.daysData.push({dayName:l.format("dddd"),desde:"",hasta:"",fecha:l.format("DD-MM-YYYY"),estaDisponible:!0,timeSlot:{time:"",estaDisponible:!0}})}}saveHorarios(){this.mySelf&&(this.mySelf.horarios=this.daysData.map(n=>({dayName:n.dayName,fecha:n.fecha,desde:n.desde,hasta:n.hasta,estaDisponible:!0,timeSlot:n.timeSlot,timeSlots:this.getTimeSlotsByRange(n.desde,n.hasta)})),this.userService.update(this.mySelf))}getTimeSlotsByRange(n,e){let l=[],h=(0,Y.default)(n,"HH:mm"),G=(0,Y.default)(e,"HH:mm");for(;h<G;)l.push({time:h.format("HH:mm"),estaDisponible:!0}),h.add(30,"minutes");return l}verHistoriaClinica(n){n&&n.historiaClinica&&n.historiaClinica.length>0&&n.historiaClinica[0].altura>0?this.dialog.open(_e,{width:"600px",data:n}):this.toast.info("Aun no posees historia cl\xEDnica")}};r.\u0275fac=function(e){return new(e||r)(f(ae),f(oe),f(he),f(I),f(ue))},r.\u0275cmp=C({type:r,selectors:[["app-mi-perfil"]],standalone:!0,features:[M],decls:5,vars:1,consts:[[1,"container-fluid"],[1,"container","mt-4"],[1,"row","container"],[3,"loading"],[1,"user-card"],[4,"ngIf"],[1,"user-details"],[1,"user-data"],[1,"btn","btn-dark","text-center"],["alt","User Image","appRoundedImg","",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"user-data","list-container"],[1,"list-data"],["data-bs-toggle","modal","data-bs-target","#horariosModal",1,"btn","btn-primary","text-center",3,"click"],[1,"btn","btn-dark","text-center",3,"click"]],template:function(e,l){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),u(3,ke,1,1,"app-spinner",3)(4,Ue,23,10),o()()()),e&2&&(s(3),_(3,l.loading?3:4))},dependencies:[ge,se,H,ne,P],styles:['.container-fluid[_ngcontent-%COMP%]{height:85vh;background-color:#6ad8d4;background-image:url("./media/main_fondo-S2RK2XML.png");background-size:250px 250px;background-repeat:repeat;background-position:center;padding:20px}.mt-4[_ngcontent-%COMP%]{height:800px}.user-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 6px #0000001a;text-align:center;margin:1em auto 0;padding:16px;width:400px}.user-details[_ngcontent-%COMP%]{font-family:Arial,sans-serif}.user-data[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:1.2em}.list-container[_ngcontent-%COMP%]{width:50%;margin-left:25%;text-align:left}.list-data[_ngcontent-%COMP%]{margin-top:.5em}button[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff}.btn[_ngcontent-%COMP%]{margin:1em}']});let i=r;return i})();var Et=(()=>{let r=class r{};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=C({type:r,selectors:[["app-perfil-container"]],standalone:!0,features:[M],decls:4,vars:0,consts:[[1,"container-fluid","m-0","p-0"]],template:function(e,l){e&1&&(a(0,"div",0),c(1,"app-navbar")(2,"app-mi-perfil")(3,"app-footer"),o())},dependencies:[Me,re,le],styles:[".user-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 6px #0000001a;max-width:300px;text-align:center;margin:0 auto;padding:16px}.user-image[_ngcontent-%COMP%]{border-radius:50%;width:100px;height:100px;object-fit:cover;margin-bottom:16px}.user-details[_ngcontent-%COMP%]{font-family:Arial,sans-serif}.user-name[_ngcontent-%COMP%], .user-email[_ngcontent-%COMP%]{margin:4px 0}.user-name[_ngcontent-%COMP%]{font-size:1.2em}.user-email[_ngcontent-%COMP%]{color:#555}"]});let i=r;return i})();export{Et as PerfilContainerComponent};
